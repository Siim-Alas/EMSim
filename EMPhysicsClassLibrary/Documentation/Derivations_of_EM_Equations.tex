\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{comment}

\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
}

\title{Derivations of EM Equations}
\author{Siim Alas}

\begin{document}

\maketitle

\section*{Introduction}

This file contains the derivations of various equations used in the computation of the \href{https://en.wikipedia.org/wiki/Electromagnetic_field}{electromagnetic field}.

\section{Retarded Potentials}

This section includes the derivations of the equations used to compute the \href{https://en.wikipedia.org/wiki/Retarded_potential}{retarded potentials}, defined in the Wikipedia article as

\begin{equation}
    \label{eq:definitionOfPhi}
    \phi(\vec{r}, t) = \frac{1}{4 \pi \epsilon_0} \int \frac{\rho(\vec{r'}, t_r)}{|\vec{r} - \vec{r'}|} d \vec{r'}
\end{equation}
\begin{equation}
    \label{eq:definitionOfA}
    \vec{A}(\vec{r}, t) = \frac{\mu_0}{4 \pi} \int \frac{\vec{J}(\vec{r'}, t_r)}{|\vec{r} - \vec{r'}|} d \vec{r'}
\end{equation}

where $\phi(\vec{r}, t)$ is the retarded \href{https://en.wikipedia.org/wiki/Electric_potential}{electric potential}, $\vec{A}(\vec{r}, t)$ is the retarded \href{https://en.wikipedia.org/wiki/Magnetic_vector_potential}{magnetic vector potential}, $\rho(\vec{r'}, t)$ is the \href{https://en.wikipedia.org/wiki/Charge_density}{charge density}, $\vec{J}(\vec{r'}, t_r)$ is the \href{https://en.wikipedia.org/wiki/Current_density}{current density}, and $t_r = t - \frac{|\vec{r} - \vec{r'}|}{c}$ is the \href{https://en.wikipedia.org/wiki/Retarded_time}{retarded time}.

\subsection{The effect of a time-invariant point charge on $\phi(\vec{r}, t)$}

The time-invariant point charge is modelled as having \href{https://en.wikipedia.org/wiki/Charge_density}{charge density}

\begin{equation}
    \label{eq:chargeDensityOfAPointCharge}
    \rho(\vec{r}, t) = q \delta(\vec{r} - \vec{r_c})
\end{equation}

where $q$ is the \href{https://en.wikipedia.org/wiki/Electric_charge}{electric charge}, $\vec{r_c}$ is the position vector of the point charge, $\delta(\vec{x})$ is the \href{https://en.wikipedia.org/wiki/Dirac_delta_function}{Dirac delta function}, generalized in the Wikipedia article to 
multiple dimensions via the identity

\begin{equation}
    \label{eq:DiracDeltaIdentityInMultipleDimensions}
    \int_{\mathbb{R}^n} f(\vec{x}) \delta(\vec{x}) d\vec{x} = f(\vec{0})
\end{equation}

which allows us to rewrite equation \ref{eq:definitionOfPhi} as

\begin{equation}
    \label{eq:phiOfAPointCharge}
    \phi(\vec{r}, t) = \frac{1}{4 \pi \epsilon_0} \int \frac{q \delta(\vec{r'} - \vec{r_c})}{|\vec{r} - \vec{r'}|} d \vec{r'} = \frac{1}{4 \pi \epsilon_0} \frac{q}{|\vec{r} - \vec{r_c}|}
\end{equation}

meaning that, because \href{https://en.wikipedia.org/wiki/Integral}{integration} is linear, the effect of a group of point charges on $\phi(\vec{r}, t)$ can be modeled as sum of such components.

\subsection{The effect of a time-invariant point charge on $\nabla \phi(\vec{r}, t)$}

Using equation \ref{eq:phiOfAPointCharge}, the effect a time-invariant point charge has on the \href{https://en.wikipedia.org/wiki/Gradient}{gradient} of $\phi(\vec{r}, t)$ is

\begin{equation}
    \label{eq:gradientOfPhiOfAPointCharge}
    \nabla \phi(\vec{r}, t) = \nabla \left( \frac{1}{4 \pi \epsilon_0} \frac{q}{|\vec{r} - \vec{r_c}|} \right) = \frac{q}{4 \pi \epsilon_0} \nabla \left( \frac{1}{|\vec{r} - \vec{r_c}|} \right) = \frac{q}{4 \pi \epsilon_0} \frac{\vec{r_c} - \vec{r}}{|\vec{r} - \vec{r_c}|^3}
\end{equation}

\subsection{The effect of a stationary straight 'wire' on $\vec{A}(\vec{r}, t)$}

A straight 'wire' is modelled as a \href{https://en.wikipedia.org/wiki/Line_segment}{line segment} with unit \href{https://en.wikipedia.org/wiki/Tangent_vector}{tangent vector} $\hat{v}$ and a \href{https://en.wikipedia.org/wiki/Current_density}{current density}, which is $\vec{J}(\vec{r'}, t_r) \parallel \hat{v}$ on the line segment and $\vec{0}$ everywhere else.

For convenience, equation \ref{eq:definitionOfA} is repeated here:

\begin{equation*}
    \vec{A}(\vec{r}, t) = \frac{\mu_0}{4 \pi} \int \frac{\vec{J}(\vec{r'}, t_r)}{|\vec{r} - \vec{r'}|} d \vec{r'}
    \tag{\ref{eq:definitionOfA}}
\end{equation*}

Changing to \href{https://en.wikipedia.org/wiki/Translation_(geometry)}{translated} \href{https://en.wikipedia.org/wiki/Spherical_coordinate_system}{spherical coordinates} via the \href{https://en.wikipedia.org/wiki/Coordinate_system#Transformations}{transformation}

\begin{equation}
    \label{eq:translatedSphericalCoordinatesForStraightWire}
    \vec{r'} = \vec{r_0} + \rho  
    \begin{bmatrix}
    \sin(\varphi) \cos(\theta) \\
    \sin(\varphi) \sin(\theta) \\
    \cos(\varphi)
    \end{bmatrix}
\end{equation}

and picking

\begin{equation}
    \label{eq:JForStraightWire}
    \vec{J}(\vec{r'}, t_r) = \frac{\delta(\varphi - \varphi_0) \delta(\theta - \theta_0) f(\rho, t_r) g(\rho)}{\rho^2 \sin(\varphi)} \hat{v}
\end{equation}

where

\begin{equation}
    \label{eq:vForStraightWire}
    \hat{v} = 
    \begin{bmatrix}
    \sin(\varphi_0) \cos(\theta_0) \\
    \sin(\varphi_0) \sin(\theta_0) \\
    \cos(\varphi_0)
    \end{bmatrix}
\end{equation}

we get

\begin{equation*}
    \vec{A}(\vec{r}, t) = \frac{\mu_0}{4 \pi} \int \frac{\vec{J}(\vec{r'}, t_r)}{|\vec{r} - \vec{r'}|} d \vec{r'} = \frac{\mu_0 \hat{v}}{4 \pi} \iiint \frac{\delta(\varphi - \varphi_0) \delta(\theta - \theta_0) f(\rho, t_r) g(\rho)}{|\vec{r} - \vec{r'}|} d \rho d \varphi d \theta
\end{equation*}

As the $\delta(\varphi - \varphi_0) \delta(\theta - \theta_0)$ in the \href{https://en.wikipedia.org/wiki/Fraction}{numerator} of the \href{https://en.wikipedia.org/wiki/Integral#Terminology_and_notation}{integrand} guarantees it will be $0$ for all $\varphi \neq \varphi_0$ and $\theta \neq \theta_0$, we can safely expand the \href{https://en.wikipedia.org/wiki/Integral}{domain of integration} from $\varphi \in [0; \pi]; \theta \in [0; 2 \pi)$ to $\varphi, \theta \in \mathbb{R}$, because the added terms in the 'sum' will all be $0$. This as well as identity \ref{eq:DiracDeltaIdentityInMultipleDimensions} along with definitions \ref{eq:translatedSphericalCoordinatesForStraightWire} and \ref{eq:vForStraightWire} allows us to simplify the integral to

\begin{equation*}
    \frac{\mu_0 \hat{v}}{4 \pi} \int \frac{f \left( \rho, t - \frac{|\vec{r} - (\vec{r_0} + \rho \hat{v})|}{c} \right) g(\rho)}{|\vec{r} - (\vec{r_0} + \rho \hat{v})|} d \rho
\end{equation*}

Further assuming that $g(\rho) = H(\rho - \rho_1) - H(\rho - \rho_2)$, where $H(x)$ is the \href{https://en.wikipedia.org/wiki/Heaviside_step_function}{heaviside step function} and $\rho_1 < \rho_2$ are \href{https://en.wikipedia.org/wiki/Constant_(mathematics)}{constants}, we can take the domain of integration to be $\rho \in [\rho_1; \rho_2]$, because all other values of $\rho$ will result in the numerator being $0$ and can thus be discarded. This allows us to write the above integral as

\begin{equation*}
    \frac{\mu_0 \hat{v}}{4 \pi} \int_{\rho_1}^{\rho_2} \frac{f(\rho, t - \frac{1}{c} |\vec{r} - (\vec{r_0} + \rho \hat{v})|)}{|\vec{r} - (\vec{r_0} + \rho \hat{v})|} d \rho
\end{equation*}

We can expand $|\vec{r} - (\vec{r_0} + \rho \hat{v})|$ as $\sqrt{|\hat{v}|^2 \rho^2 - 2 \rho (\hat{v} \cdot (\vec{r} - \vec{r_0})) + |\vec{r} - \vec{r_0}|^2}$. Note that as $\hat{v}$ is a unit vector, then by definition $|\hat{v}|^2 = |\hat{v}| = 1$. Extracting the square allows us to rewrite the \href{https://en.wikipedia.org/wiki/Expression_(mathematics)}{expression} under the \href{https://en.wikipedia.org/wiki/Radical_symbol}{radical} as

\begin{equation*}
    (\rho - (\hat{v} \cdot (\vec{r} - \vec{r_0})))^2 - (\hat{v} \cdot (\vec{r} - \vec{r_0}))^2 + |\vec{r} - \vec{r_0}|^2
\end{equation*}

Defining $y = |\vec{r} - \vec{r_0}|^2 - (\hat{v} \cdot (\vec{r} - \vec{r_0}))^2$, we can \href{https://en.wikipedia.org/wiki/Change_of_variables}{change variables} via the relation $x = \rho - (\hat{v} \cdot (\vec{r} - \vec{r_0})) \Rightarrow dx = d \rho$, rewriting $|\vec{r} - (\vec{r_0} + \rho \hat{v})|$ as $\sqrt{x^2 + y}$ and, subsequently, the integral as

\begin{equation}
    \label{eq:simplifiedIntegralForTheEffectOfAStationaryStraightWireOnA}
    \vec{A}(\vec{r}, t) = \frac{\mu_0 \hat{v}}{4 \pi} \int_{x_1}^{x_2} \frac{f(x + (\hat{v} \cdot (\vec{r} - \vec{r_0})), t - \frac{1}{c} \sqrt{x^2 + y})}{\sqrt{x^2 + y}} dx
\end{equation}

where $x_n = \rho_n - (\hat{v} \cdot (\vec{r} - \vec{r_0}))$.

\subsubsection{The special case of constant current}

In the special case of $f(x + (\hat{v} \cdot (\vec{r} - \vec{r_0})), t - \frac{1}{c} \sqrt{x^2 + y}) = I$, where $I$ is a constant, the integral in equation \ref{eq:simplifiedIntegralForTheEffectOfAStationaryStraightWireOnA} can be solved analytically by noting that $\frac{d}{dx} \arcsin(x) = \frac{1}{\sqrt{1-x^2}}$. This allows us to change variables to $i \sqrt{y} u = x \Rightarrow i \sqrt{y} du = dx$ and write the integral as

\begin{equation*}
    \frac{\mu_0 \hat{v}}{4 \pi} \int_{u_1}^{u_2} \frac{I}{\sqrt{y - y u^2}} i \sqrt{y} dx = i \frac{\mu_0 \hat{v} I}{4 \pi} \int_{u_1}^{u_2} \frac{1}{\sqrt{1 - u^2}} dx = i \frac{\mu_0 \hat{v} I}{4 \pi} (\arcsin(u) + C) |_{u_1}^{u_2}
\end{equation*}

where $u_n = - \frac{i}{\sqrt{y}} x_n$.

Using the \href{https://en.wikipedia.org/wiki/List_of_trigonometric_identities#Exponential_definitions}{exponential definition} $\arcsin(u) = -i\ln(iu + \sqrt{1 - u^2})$, we get

\begin{equation*}
    i \frac{\mu_0 \hat{v} I}{4 \pi} (-i\ln(iu + \sqrt{1 - u^2})) |_{u_1}^{u_2} = \frac{\mu_0 \hat{v} I}{4 \pi} \ln \left( i(- \frac{i}{\sqrt{y}} x) + \sqrt{1 - (- \frac{i}{\sqrt{y}} x)^2} \right) |_{x_1}^{x_2} =
\end{equation*}
\begin{equation*}
    = \frac{\mu_0 \hat{v} I}{4 \pi} \ln \left( \frac{x + \sqrt{y + x^2}}{\sqrt{y}} \right) |_{x_1}^{x_2} = \frac{\mu_0 \hat{v} I}{4 \pi} \ln \left( \frac{x_2 + \sqrt{(x_2)^2 + y}}{x_1 + \sqrt{(x_1)^2 + y}} \right)
\end{equation*}

Transitioning back to the coordinates of definition \ref{eq:translatedSphericalCoordinatesForStraightWire}, the effect a stationary straight wire with constant current $I$ has on $\vec{A}(\vec{r}, t)$ can be expressed as

\begin{equation}
    \label{eq:effectOfStationaryStraightWireWithConstantCurrentOnA}
    \vec{A}(\vec{r}, t) = \frac{\mu_0 \hat{v} I}{4 \pi} \ln \left( \frac{\rho_2 - (\hat{v} \cdot (\vec{r} - \vec{r_0})) + |\vec{r} - (\vec{r_0} + \rho_2 \hat{v})|}{\rho_1 - (\hat{v} \cdot (\vec{r} - \vec{r_0})) + |\vec{r} - (\vec{r_0} + \rho_1 \hat{v})|} \right)
\end{equation}

If we assume $\rho_1 = 0$ and define $\vec{r_1} = \vec{r_0} + \rho_2 \hat{v} \Rightarrow \rho_2 = |r_1 - r_0|$, then the above expression turns into

\begin{equation*}
    \vec{A}(\vec{r}, t) = \frac{\mu_0 \hat{v} I}{4 \pi} \ln \left( \frac{|\vec{r_1} - \vec{r_0}| - (\hat{v} \cdot (\vec{r} - \vec{r_0})) + |\vec{r} - \vec{r_1}|}{|\vec{r} - \vec{r_0}| - (\hat{v} \cdot (\vec{r} - \vec{r_0}))} \right)
\end{equation*}

Finally, note that this result also \href{https://en.wikipedia.org/wiki/Approximation}{approximates} cases where $I$ does depend on time, but $t_r \approx t$. In these cases, the current can be approximated as $I(t_r) \approx I(t)$ and brought outside the integral just like a constant current.

\subsubsection{The not-so-special case of exponential current}

In the more generalized case of $f(\rho, t_r) = e^{a(t_r - \frac{\rho}{c})} = e^{a((t - \frac{1}{c} \sqrt{x^2 + y}) - \frac{x + (\hat{v} \cdot (\vec{r} - \vec{r_0}))}{c})}$, where $a$ may be complex, an analytic solution to equation \ref{eq:simplifiedIntegralForTheEffectOfAStationaryStraightWireOnA} can be found, but only as a non-\href{https://en.wikipedia.org/wiki/Elementary_function}{elementary} function. This is done by changing variables via

\begin{equation*}
    u = \ln \left( \frac{x + \sqrt{x^2 + y}}{\sqrt{y}} \right) \Rightarrow du = \frac{dx}{\sqrt{x^2 + y}} \Rightarrow dx = \sqrt{x^2 + y} du
\end{equation*}

and writing $f(\rho, t_r)$ as

\begin{equation*}
    e^{a(t - \frac{\hat{v} \cdot (\vec{r} - \vec{r_0})}{c} - \frac{1}{c} (x + \sqrt{x^2 + y}))} = e^{a(t - \frac{\hat{v} \cdot (\vec{r} - \vec{r_0})}{c} - \frac{\sqrt{y}}{c} e^u)}
\end{equation*}

allowing us to write the integral as

\begin{equation*}
   \vec{A}(\vec{r}, t) = \frac{\mu_0 \hat{v}}{4 \pi} e^{a(t - \frac{\hat{v} \cdot (\vec{r} - \vec{r_0})}{c})} \int_{u_1}^{u_2} e^{- \frac{a \sqrt{y}}{c} e^u} du
\end{equation*}

where $u_n = \ln \left( \frac{x_n + \sqrt{x_n^2 + y}}{\sqrt{y}} \right)$.

Using the \href{https://en.wikipedia.org/wiki/Leibniz_integral_rule}{Leibniz integral rule}, presented in the Wikipeida article as

\begin{equation*}
    \frac{d}{dx} \left( \int_{a(x)}^{b(x)} f(x, t) dt \right) = f(x, b(x)) \frac{db(x)}{dx} - f(x, a(x)) \frac{da(x)}{dx} + \int_{a(x)}^{b(x)} \frac{\partial}{\partial x} f(x, t) dt
\end{equation*}

we can see that in the case of $\frac{\partial}{\partial x} f(x, t) = 0$, the conditions $f(x, a(x)) \frac{da(x)}{dx} = e^{- \frac{a \sqrt{y}}{c} e^x}$ (note that in this case $a(x) \neq a$) and $\frac{db(x)}{dx} = 0$ are enough to guarantee that $- \int_{a(x)}^{b(x)} f(x, t) dt$ is a solution to our integral above.

The condition $\frac{\partial}{\partial x} f(x, t) = 0$ means that $f(x, t) = f(t)$ is only a function of the second variable ($t$ in this case), leaving us with the condition $f(a(x)) \frac{da(x)}{dx} = e^{- \frac{a \sqrt{y}}{c} e^x}$. A convenient way to solve this would be to set $a(x) = \frac{da(x)}{dx} = \frac{a \sqrt{y}}{c} e^x$ and then $f(t) = \frac{1}{t} e^{- t}$. Finally, because of the condition $\frac{db(x)}{dx} = 0$, we set that to an arbitrary constant. In conclusion, we have

\begin{equation*}
    \frac{d}{dx} \left( \int_{\frac{a \sqrt{y}}{c} e^x}^{b} \frac{e^{- t}}{t} dt \right) = 0 - \frac{e^{- \frac{a \sqrt{y}}{c} e^x}}{\frac{a \sqrt{y}}{c} e^x} (\frac{a \sqrt{y}}{c} e^x) + \int_{\frac{a \sqrt{y}}{c} e^x}^{b} \frac{\partial}{\partial x} (\frac{e^{-t}}{t}) dt = - e^{- \frac{a \sqrt{y}}{c} e^x}
\end{equation*}

If we take $b = \infty$, then this can be succinctly written as

\begin{equation*}
    \frac{d}{dx} E_1(\frac{a \sqrt{y}}{c} e^x) = - e^{- \frac{a \sqrt{y}}{c} e^x}
\end{equation*}

where $E_1(x)$ is the \href{https://en.wikipedia.org/wiki/Exponential_integral}{exponential integral}, generalized to complex variables. This allows us to rewrite the original integral as

\begin{equation*}
    \frac{\mu_0 \hat{v}}{4 \pi} e^{a(t - \frac{\hat{v} \cdot (\vec{r} - \vec{r_0})}{c})} \int_{u_1}^{u_2} - \frac{d}{du} E_1(\frac{a \sqrt{y}}{c} e^u) du =
\end{equation*}
\begin{equation*}
    = - \frac{\mu_0 \hat{v}}{4 \pi} e^{a(t - \frac{\hat{v} \cdot (\vec{r} - \vec{r_0})}{c})} E_1(\frac{a \sqrt{y}}{c} e^u) |_{u_1}^{u_2} =
\end{equation*}
\begin{equation*}
    = - \frac{\mu_0 \hat{v}}{4 \pi} e^{a(t - \frac{\hat{v} \cdot (\vec{r} - \vec{r_0})}{c})} E_1 \left( \frac{a}{c} (x + \sqrt{x^2 + y}) \right) |_{x_1}^{x_2}
\end{equation*}

Transitioning back to the coordinates of definition \ref{eq:translatedSphericalCoordinatesForStraightWire}, we get

\begin{equation}
    \label{eq:effectOfAStationaryStraightWireWithExponentialCurrentOnA}
    \vec{A}(\vec{r}, t) = - \frac{\mu_0 \hat{v}}{4 \pi} e^{a(t - \frac{\hat{v} \cdot (\vec{r} - \vec{r_0})}{c})} E_1 \left( \frac{a}{c} (\rho - (\hat{v} \cdot (\vec{r} - \vec{r_0})) + |\vec{r} - (\vec{r_0} + \rho \hat{v})|) \right) |_{\rho_1}^{\rho_2}
\end{equation}

\end{document}
